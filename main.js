!function(){"use strict";function e(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function t(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var i=class{constructor(e){t(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),t(this,"_handleShadedClose",(e=>{e.target===e.currentTarget&&this.close()})),this._popupElement=document.querySelector(e),this.close=this.close.bind(this)}open(){this._popupElement.classList.add("modal_opened"),this.setEventListeners()}close(){this._popupElement.classList.remove("modal_opened"),this.removeEventListeners()}setEventListeners(){this._popupElement.addEventListener("mousedown",this._handleShadedClose),document.addEventListener("keyup",this._handleEscClose),this._closeButton=this._popupElement.querySelector(".modal__close-button"),this._closeButton.addEventListener("click",this.close)}removeEventListeners(){this._popupElement.removeEventListener("mousedown",this._handleShadedClose),document.removeEventListener("keyup",this._handleEscClose),this._closeButton.removeEventListener("click",this.close)}};var s=class extends i{constructor(e){let{popupSelector:t,handleFormSubmit:i,loadingButtonText:s}=e;var n,r,o;super(t),n=this,o=e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t)},(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(r="_onSubmit"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this._popupForm=this._popupElement.querySelector(".modal__container"),this._handleFormSubmit=i,this._inputList=[...this._popupForm.querySelectorAll(".modal__container-input")],this._submitButton=this._popupElement.querySelector(".modal__container-button"),this._buttonText=this._submitButton.textContent,this._loadingButtonText=s}showLoading(){this._submitButton.textContent=this._loadingButtonText}hideLoading(){this._submitButton.textContent=this._buttonText}_getInputValues(){const e={};for(const t of this._inputList)e[t.name]=t.value;return e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._onSubmit)}removeEventListeners(){super.removeEventListeners(),this._popupForm.removeEventListener("submit",this._onSubmit)}close(){this._popupForm.reset(),super.close()}};class n{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e._inputErrorClass,this._form=document.querySelector(t),this._inputElements=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageElement.textContent=e.validationMessage}_hideInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageElement.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(e){return!e.every((e=>e.validity.valid))}toggleButtonState(){this._hasInvalidInput(this._inputElements)?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this.toggleButtonState(this._submitButton),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState(this._submitButton)}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const r={inputSelector:".modal__container-input",submitButtonSelector:".modal__container-button",inactiveButtonClass:"modal__container-button_disabled",inputErrorClass:"modal__container-input_type_error"};function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const a=new class{constructor(e){o(this,"_processResponse",(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))),o(this,"getAppInfo",(()=>Promise.all([this.getUserInfo(),this.getInitialCards()]))),this.baseUrl=e.baseUrl,this.headers=e.headers}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{method:"GET",headers:this.headers}).then(this._processResponse)}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{method:"GET",headers:this.headers}).then(this._processResponse)}editProfile(e){return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._processResponse)}addCard(e){return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._processResponse)}deleteCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then(this._processResponse)}addLike(e){return fetch(`${this.baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this.headers}).then(this._processResponse)}removeLike(e){return fetch(`${this.baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this.headers}).then(this._processResponse)}updateImage(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e.avatar})}).then(this._processResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"e670e45b-056f-48c1-a43f-65723fd263c0","Content-Type":"application/json"}});let l,u;const h=new class{constructor(e){let{userNameSelector:t,userJobSelector:i,userImageSelector:s}=e;this._name=document.querySelector(t),this._job=document.querySelector(i),this._image=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,about:this._job.textContent}}getAvatar(){return{image:this._image.src}}setUserInfo(e){let{name:t,about:i}=e;this._name.textContent=t,this._job.textContent=i}setImage(e){this._image.src=e,this._image.alt=this._name.textContent}}({userNameSelector:".profile__info-name",userJobSelector:".profile__info-description",userImageSelector:".profile__image"}),c=new class extends i{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__container"),this._submitButton=this._popupElement.querySelector(".modal__container-button"),this._buttonText=this._submitButton.textContent,this._loadingButtonText=t}showLoading(){this._submitButton.textContent=this._loadingButtonText}hideLoading(){this._submitButton.textContent=this._buttonText}setSubmitCallback(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()}))}removeEventListeners(){super.removeEventListeners(),this._popupForm.removeEventListener("submit",this.setSubmitCallback)}close(){this._popupForm.reset(),super.close()}}("#deleteCardModal","Deleting..."),d=t=>{const i=new class{constructor(t,i,s,n){let{handleCardClick:r,handleDeleteClick:o,handleLikeClick:a}=i;e(this,"renderLikes",(()=>{this.isLiked()?this._cardLikeButton.classList.add("card__like-button_filled"):this._cardLikeButton.classList.remove("card__like-button_filled"),this._cardLikes.textContent=this._likes.length})),e(this,"handleDeleteButton",(()=>{this._cardElement.remove(),this._cardElement=null})),this._name=t.name,this._link=t.link,this._id=t._id,this._likes=t.likes,this._ownerId=t.owner._id,this._handleCardClick=r,this._handleDeleteClick=o,this._handleLikeClick=a,this._cardSelector=s,this._userId=n}getId(){return this._id}_setEventListeners(){this._cardLikeButton.addEventListener("click",this._handleLikeClick),this._cardDeleteButton.addEventListener("click",this._handleDeleteClick),this._imageElement.addEventListener("click",this._handleCardClick)}updateLikes(e){this._likes=e,this.renderLikes()}isLiked(){return this._likes.some((e=>e._id===this._userId))}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){this._cardElement=this._getTemplate(),this._cardLikeButton=this._cardElement.querySelector(".card__like-button"),this._imageElement=this._cardElement.querySelector(".card__image");const e=this._cardElement.querySelector(".card__tab-title");return this._cardDeleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardLikes=this._cardElement.querySelector(".card__like-number"),this._imageElement.src=this._link,this._imageElement.alt=this._name,e.textContent=this._name,this._setEventListeners(),this.renderLikes(),this._ownerId!==this._userId&&this._cardDeleteButton.remove(),this._cardElement}}(t,{handleCardClick:()=>{m.open(t)},handleDeleteClick:()=>{const e=i.getId();c.open(),c.setSubmitCallback((()=>{c.showLoading(),a.deleteCard(e).then((()=>{i.handleDeleteButton(),c.close()})).catch((e=>console.log(e))).finally((()=>{c.hideLoading()}))}))},handleLikeClick:()=>{const e=i.getId();i.isLiked()?a.removeLike(e).then((e=>{i.updateLikes(e.likes)})).catch((e=>console.log(e))):a.addLike(e).then((e=>{i.updateLikes(e.likes)})).catch((e=>console.log(e)))}},"#card-template",u);return i.getView()};a.getAppInfo().then((e=>{let[t,i]=e;h.setUserInfo({name:t.name,about:t.about}),h.setImage(t.avatar),u=t._id,i.reverse(),l=new class{constructor(e,t){let{items:i,renderer:s}=e;this._renderedItems=i,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._renderedItems.forEach(this._renderer)}addItem(e){this._container.prepend(e)}}({items:i,renderer:e=>{const t=d(e);l.addItem(t)}},".cards__list"),l.renderItems()})).catch((e=>console.log(e)));const m=new class extends i{constructor(e){super(e),this._previewImage=this._popupElement.querySelector(".modal-preview-image"),this._imageCaption=this._popupElement.querySelector(".modal-preview-description")}open(e){let{name:t,link:i}=e;this._previewImage.src=i,this._previewImage.alt=t,this._imageCaption.textContent=t,super.open()}}("#imageModal"),_=new s({popupSelector:"#editModal",handleFormSubmit:e=>{_.showLoading(),a.editProfile(e).then((()=>{h.setUserInfo(e),_.close()})).catch((e=>console.log(e))).finally((()=>{_.hideLoading()}))},loadingButtonText:"Saving..."}),p=new s({popupSelector:"#addModal",handleFormSubmit:e=>{p.showLoading(),a.addCard(e).then((e=>{!function(e){const t=d(e);l.addItem(t)}(e),p.close()})).catch((e=>console.log(e))).finally((()=>{p.hideLoading()}))},loadingButtonText:"Saving..."}),v=new s({popupSelector:"#change-image-modal",handleFormSubmit:e=>{v.showLoading(),a.updateImage(e).then((()=>{h.setImage(e.avatar),v.close()})).catch((e=>console.log(e))).finally((()=>{v.hideLoading()}))},loadingButtonText:"Saving..."}),b=new n(r,"#edit-profile-form"),g=new n(r,"#add-card-form"),f=new n(r,"#change-image-form");b.enableValidation(),g.enableValidation(),f.enableValidation();const E=document.querySelector(".profile__info-button"),S=document.querySelector(".profile__button"),L=document.querySelector("#name"),y=document.querySelector("#description"),k=document.querySelector("#avatar"),C=document.querySelector(".profile__overlay-button");E.addEventListener("click",(()=>{!function(){const e=h.getUserInfo();L.value=e.name,y.value=e.about}(),b.toggleButtonState(),_.open()})),S.addEventListener("click",(()=>{g.toggleButtonState(),p.open()})),C.addEventListener("click",(()=>{!function(){const e=h.getAvatar();k.value=e.image}(),f.toggleButtonState(),v.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBb0I1TCxTQUFTQyxjQUFjLGdCQUMzQzRMLEVBQW9CN0wsU0FBU0MsY0FBYyxXQUMzQzZMLEVBQTJCOUwsU0FBU0MsY0FBYyw0QkFheER3TCxFQUFrQmhMLGlCQUFpQixTQUFTLE1BWDVDLFdBQ0UsTUFBTXNMLEVBQWMzRixFQUFTeEIsY0FDN0IrRyxFQUFpQjFKLE1BQVE4SixFQUFZL0osS0FDckM0SixFQUFrQjNKLE1BQVE4SixFQUFZdEcsS0FDeEMsQ0FRRXVHLEdBQ0FWLEVBQWtCMUgsb0JBQ2xCbUgsRUFBUzVLLE1BQU0sSUFFakJ1TCxFQUFlakwsaUJBQWlCLFNBQVMsS0FDdkM4SyxFQUFpQjNILG9CQUNqQnNILEVBQVEvSyxNQUFNLElBR2hCMkwsRUFBeUJyTCxpQkFBaUIsU0FBUyxNQWZuRCxXQUNFLE1BQU13TCxFQUFhN0YsRUFBU08sWUFDNUJrRixFQUFrQjVKLE1BQVFnSyxFQUFXckYsS0FDdkMsQ0FhRXNGLEdBQ0FWLEVBQW9CNUgsb0JBQ3BCeUgsRUFBZ0JsTCxNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5jbG9zZSA9IHRoaXMuY2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgdGhpcy5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2ZW50KSA9PiB7XG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH07XG4gIH1cblxuICBfaGFuZGxlU2hhZGVkQ2xvc2UgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSBldmVudC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZVNoYWRlZENsb3NlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5jbG9zZSk7XG4gIH1cblxuICByZW1vdmVFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVTaGFkZWRDbG9zZSk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5jbG9zZSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXA7IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCwgbG9hZGluZ0J1dHRvblRleHQgfSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIFxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jb250YWluZXJcIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gWy4uLnRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jb250YWluZXItaW5wdXRcIildO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jb250YWluZXItYnV0dG9uXCIpO1xuICAgIHRoaXMuX2J1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gICAgdGhpcy5fbG9hZGluZ0J1dHRvblRleHQgPSBsb2FkaW5nQnV0dG9uVGV4dDtcbiAgfVxuXG4gIHNob3dMb2FkaW5nKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX2xvYWRpbmdCdXR0b25UZXh0O1xuICB9XG5cbiAgaGlkZUxvYWRpbmcoKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fYnV0dG9uVGV4dDtcbiAgfVxuXG4gIF9vblN1Ym1pdCA9IChldmVudCkgPT4ge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG5cbiAgICBmb3IgKGNvbnN0IGlucHV0IG9mIHRoaXMuX2lucHV0TGlzdCkge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9vblN1Ym1pdCk7XG4gIH1cblxuICByZW1vdmVFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX29uU3VibWl0KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuXG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtOyIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLl9pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZm9ybUVsZW1lbnQpO1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcbiAgICByZXR1cm4gIWlucHV0TGlzdC5ldmVyeSgoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dEVsZW1lbnRzKSkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX3N1Ym1pdEJ1dHRvbik7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5fc3VibWl0QnV0dG9uKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICBcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbn1cblxuZXhwb3J0IHtGb3JtVmFsaWRhdG9yfTsiLCJjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19jb250YWluZXItaW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19jb250YWluZXItYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2NvbnRhaW5lci1idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19jb250YWluZXItaW5wdXRfdHlwZV9lcnJvclwiLFxufTtcblxuY29uc3Qgc2VsZWN0b3JzID0ge1xuICBjYXJkVGVtcGxhdGU6IFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgY2FyZExpc3Q6IFwiLmNhcmRzX19saXN0XCIsXG4gIGVkaXRQb3B1cDogXCIjZWRpdE1vZGFsXCIsXG4gIGFkZFBvcHVwOiBcIiNhZGRNb2RhbFwiLFxuICBkZWxldGVDYXJkUG9wdXA6IFwiI2RlbGV0ZUNhcmRNb2RhbFwiLFxuICBwcm9maWxlTmFtZTogXCIucHJvZmlsZV9faW5mby1uYW1lXCIsXG4gIHByb2ZpbGVEZXNjcmlwdGlvbjogXCIucHJvZmlsZV9faW5mby1kZXNjcmlwdGlvblwiLFxuICBwcm9maWxlSW1hZ2U6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG4gIGVkaXRGb3JtRWxlbWVudDogXCIjZWRpdC1wcm9maWxlLWZvcm1cIixcbiAgYWRkRm9ybUVsZW1lbnQ6IFwiI2FkZC1jYXJkLWZvcm1cIixcbiAgY2hhbmdlRm9ybUVsZW1lbnQ6IFwiI2NoYW5nZS1pbWFnZS1mb3JtXCIsXG4gIHByZXZpZXdJbWFnZTogXCIjaW1hZ2VNb2RhbFwiLFxuICBjaGFuZ2VJbWFnZVBvcHVwOiBcIiNjaGFuZ2UtaW1hZ2UtbW9kYWxcIlxufVxuXG5leHBvcnQge3ZhbGlkYXRpb25TZXR0aW5ncywgc2VsZWN0b3JzfTsiLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQge0Zvcm1WYWxpZGF0b3J9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCB7dmFsaWRhdGlvblNldHRpbmdzLCBzZWxlY3RvcnN9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanNcIjtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJlNjcwZTQ1Yi0wNTZmLTQ4YzEtYTQzZi02NTcyM2ZkMjYzYzBcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICB9XG59KTtcblxubGV0IGNhcmRTZWN0aW9uO1xubGV0IHVzZXJJZDtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICB1c2VyTmFtZVNlbGVjdG9yOiBzZWxlY3RvcnMucHJvZmlsZU5hbWUsXG4gIHVzZXJKb2JTZWxlY3Rvcjogc2VsZWN0b3JzLnByb2ZpbGVEZXNjcmlwdGlvbixcbiAgdXNlckltYWdlU2VsZWN0b3I6IHNlbGVjdG9ycy5wcm9maWxlSW1hZ2Vcbn0pO1xuXG5jb25zdCBjb25maXJtRm9ybSA9IG5ldyBQb3B1cFdpdGhDb25maXJtKHNlbGVjdG9ycy5kZWxldGVDYXJkUG9wdXAsIFwiRGVsZXRpbmcuLi5cIik7XG5cbmNvbnN0IGNyZWF0ZUNhcmQgPSAoaXRlbSkgPT4ge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgaXRlbSwge1xuICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xuICAgICAgaW1hZ2VQb3B1cC5vcGVuKGl0ZW0pO1xuICAgIH0sXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2s6ICgpID0+IHtcbiAgICAgIGNvbnN0IGNhcmRJZCA9IGNhcmQuZ2V0SWQoKTtcbiAgICAgIGNvbmZpcm1Gb3JtLm9wZW4oKTtcbiAgICAgIGNvbmZpcm1Gb3JtLnNldFN1Ym1pdENhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgY29uZmlybUZvcm0uc2hvd0xvYWRpbmcoKTtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmRlbGV0ZUNhcmQoY2FyZElkKVxuICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQnV0dG9uKCk7XG4gICAgICAgICAgICBjb25maXJtRm9ybS5jbG9zZSgpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXG4gICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgY29uZmlybUZvcm0uaGlkZUxvYWRpbmcoKTtcbiAgICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9LFxuICAgIGhhbmRsZUxpa2VDbGljazogKCkgPT4ge1xuICAgICAgY29uc3QgY2FyZElkID0gY2FyZC5nZXRJZCgpO1xuICAgICAgaWYgKGNhcmQuaXNMaWtlZCgpKSB7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5yZW1vdmVMaWtlKGNhcmRJZClcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcGlcbiAgICAgICAgICAuYWRkTGlrZShjYXJkSWQpXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhyZXMubGlrZXMpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xuICAgICAgfVxuICAgIH1cbiAgfSwgXG4gICAgc2VsZWN0b3JzLmNhcmRUZW1wbGF0ZSxcbiAgICB1c2VySWRcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xufVxuXG5hcGlcbiAgLmdldEFwcEluZm8oKVxuICAudGhlbigoW3VzZXJSZXMsIGNhcmRSZXNdKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgbmFtZTogdXNlclJlcy5uYW1lLFxuICAgICAgYWJvdXQ6IHVzZXJSZXMuYWJvdXRcbiAgICB9KTtcbiAgICB1c2VySW5mby5zZXRJbWFnZSh1c2VyUmVzLmF2YXRhcik7XG4gICAgdXNlcklkID0gdXNlclJlcy5faWQ7XG4gICAgY2FyZFJlcy5yZXZlcnNlKCk7XG4gICAgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbih7XG4gICAgICBpdGVtczogY2FyZFJlcyxcbiAgICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSk7XG4gICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgc2VsZWN0b3JzLmNhcmRMaXN0XG4gICAgKVxuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGRhdGEpIHtcbiAgY29uc3QgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQoZGF0YSk7XG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0obmV3Q2FyZCk7XG59XG5cbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoc2VsZWN0b3JzLnByZXZpZXdJbWFnZSk7XG5cbmNvbnN0IGVkaXRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oeyBcbiAgcG9wdXBTZWxlY3Rvcjogc2VsZWN0b3JzLmVkaXRQb3B1cCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKHZhbHVlcykgPT4ge1xuICAgIGVkaXRGb3JtLnNob3dMb2FkaW5nKCk7XG4gICAgYXBpXG4gICAgICAuZWRpdFByb2ZpbGUodmFsdWVzKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh2YWx1ZXMpO1xuICAgICAgICBlZGl0Rm9ybS5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBlZGl0Rm9ybS5oaWRlTG9hZGluZygpO1xuICAgICAgfSlcbiAgfSxcbiAgbG9hZGluZ0J1dHRvblRleHQ6IFwiU2F2aW5nLi4uXCJcbn0pO1xuY29uc3QgYWRkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3Rvcjogc2VsZWN0b3JzLmFkZFBvcHVwLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoaXRlbSkgPT4ge1xuICAgIGFkZEZvcm0uc2hvd0xvYWRpbmcoKTtcbiAgICBhcGlcbiAgICAgIC5hZGRDYXJkKGl0ZW0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIHJlbmRlckNhcmQocmVzKTtcbiAgICAgICAgYWRkRm9ybS5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBhZGRGb3JtLmhpZGVMb2FkaW5nKCk7XG4gICAgICB9KVxuICB9LFxuICBsb2FkaW5nQnV0dG9uVGV4dDogXCJTYXZpbmcuLi5cIlxufSk7XG5cbmNvbnN0IGNoYW5nZUltYWdlRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3Rvcjogc2VsZWN0b3JzLmNoYW5nZUltYWdlUG9wdXAsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChpdGVtKSA9PiB7XG4gICAgY2hhbmdlSW1hZ2VGb3JtLnNob3dMb2FkaW5nKClcbiAgICBhcGlcbiAgICAgIC51cGRhdGVJbWFnZShpdGVtKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRJbWFnZShpdGVtLmF2YXRhcik7XG4gICAgICAgIGNoYW5nZUltYWdlRm9ybS5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBjaGFuZ2VJbWFnZUZvcm0uaGlkZUxvYWRpbmcoKTtcbiAgICAgIH0pXG4gIH0sXG4gIGxvYWRpbmdCdXR0b25UZXh0OiBcIlNhdmluZy4uLlwiXG59KVxuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgc2VsZWN0b3JzLmVkaXRGb3JtRWxlbWVudCk7XG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBzZWxlY3RvcnMuYWRkRm9ybUVsZW1lbnQpO1xuY29uc3QgY2hhbmdlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgc2VsZWN0b3JzLmNoYW5nZUZvcm1FbGVtZW50KTtcblxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5jaGFuZ2VGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2luZm8tYnV0dG9uXCIpO1xuY29uc3QgYWRkUG9wdXBCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2J1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25hbWVcIik7XG5jb25zdCBwcm9maWxlQWJvdXRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVzY3JpcHRpb25cIik7XG5jb25zdCBwcm9maWxlSW1hZ2VJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyXCIpO1xuY29uc3QgY2hhbmdlUHJvZmlsZUltYWdlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19vdmVybGF5LWJ1dHRvblwiKTtcblxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKCkge1xuICBjb25zdCBwcm9maWxlSW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlSW5mby5uYW1lO1xuICBwcm9maWxlQWJvdXRJbnB1dC52YWx1ZSA9IHByb2ZpbGVJbmZvLmFib3V0O1xufVxuXG5mdW5jdGlvbiBmaWxsQXZhdGFyRm9ybSgpIHtcbiAgY29uc3QgYXZhdGFySW5mbyA9IHVzZXJJbmZvLmdldEF2YXRhcigpO1xuICBwcm9maWxlSW1hZ2VJbnB1dC52YWx1ZSA9IGF2YXRhckluZm8uaW1hZ2U7XG59XG5cbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGZpbGxQcm9maWxlRm9ybSgpO1xuICBlZGl0Rm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICBlZGl0Rm9ybS5vcGVuKCk7XG59KTtcbmFkZFBvcHVwQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgYWRkRm9ybS5vcGVuKClcbn0pO1xuXG5jaGFuZ2VQcm9maWxlSW1hZ2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZmlsbEF2YXRhckZvcm0oKTtcbiAgY2hhbmdlRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICBjaGFuZ2VJbWFnZUZvcm0ub3BlbigpO1xufSk7IiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLmJhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLmhlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfcHJvY2Vzc1Jlc3BvbnNlID0gKHJlcykgPT4ge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKVxyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnNcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSlcclxuICB9XHJcblxyXG4gIGVkaXRQcm9maWxlKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0OiBkYXRhLmFib3V0XHJcbiAgICAgIH0pLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKVxyXG4gIH1cclxuXHJcbiAgYWRkQ2FyZChkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgIGxpbms6IGRhdGEubGlua1xyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKVxyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2RhdGF9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSlcclxuICB9XHJcblxyXG4gIGFkZExpa2UoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtkYXRhfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnNcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSlcclxuICB9XHJcblxyXG4gIHJlbW92ZUxpa2UoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtkYXRhfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnNcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSlcclxuICB9XHJcblxyXG4gIHVwZGF0ZUltYWdlKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogZGF0YS5hdmF0YXJcclxuICAgICAgfSksXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKVxyXG4gIH0gXHJcblxyXG4gIGdldEFwcEluZm8gPSAoKSA9PiB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpOyIsImNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyB1c2VyTmFtZVNlbGVjdG9yLCB1c2VySm9iU2VsZWN0b3IsIHVzZXJJbWFnZVNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJKb2JTZWxlY3Rvcik7XG4gICAgdGhpcy5faW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJJbWFnZVNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxuICAgICAgYWJvdXQ6IHRoaXMuX2pvYi50ZXh0Q29udGVudFxuICAgIH1cbiAgfVxuXG4gIGdldEF2YXRhcigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaW1hZ2U6IHRoaXMuX2ltYWdlLnNyY1xuICAgIH1cbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2pvYi50ZXh0Q29udGVudCA9IGFib3V0XG4gIH1cblxuICBzZXRJbWFnZShpbWFnZSkge1xuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGltYWdlO1xuICAgIHRoaXMuX2ltYWdlLmFsdCA9IHRoaXMuX25hbWUudGV4dENvbnRlbnQ7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVXNlckluZm87IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhDb25maXJtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGxvYWRpbmdCdXR0b25UZXh0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIFxyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NvbnRhaW5lclwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jb250YWluZXItYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fYnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICAgIHRoaXMuX2xvYWRpbmdCdXR0b25UZXh0ID0gbG9hZGluZ0J1dHRvblRleHQ7XHJcbiAgfVxyXG5cclxuICBzaG93TG9hZGluZygpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX2xvYWRpbmdCdXR0b25UZXh0O1xyXG4gIH1cclxuXHJcbiAgaGlkZUxvYWRpbmcoKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9idXR0b25UZXh0O1xyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0Q2FsbGJhY2soZXZlbnQpIHtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBldmVudDtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnJlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLnNldFN1Ym1pdENhbGxiYWNrKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcblxyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aENvbmZpcm07IiwiY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKCBkYXRhLCB7IGhhbmRsZUNhcmRDbGljaywgaGFuZGxlRGVsZXRlQ2xpY2ssIGhhbmRsZUxpa2VDbGljayB9LCBjYXJkU2VsZWN0b3IsIHVzZXJJZCApIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICB9XG5cbiAgZ2V0SWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lkO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlQ2xpY2spO1xuICAgIHRoaXMuX2NhcmREZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNhcmRDbGljayk7XG4gIH1cblxuICByZW5kZXJMaWtlcyA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHtcbiAgICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9maWxsZWRcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9maWxsZWRcIik7XG4gICAgfVxuICAgIHRoaXMuX2NhcmRMaWtlcy50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgfVxuXG4gIHVwZGF0ZUxpa2VzKGxpa2VzKSB7XG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcbiAgICB0aGlzLnJlbmRlckxpa2VzKCk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcbiAgfVxuXG4gIGhhbmRsZURlbGV0ZUJ1dHRvbiA9ICgpID0+IHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RhYi10aXRsZVwiKTtcbiAgICB0aGlzLl9jYXJkRGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2NhcmRMaWtlcyA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1udW1iZXJcIik7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IHRoaXMuX25hbWU7XG4gICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMucmVuZGVyTGlrZXMoKTtcblxuICAgIGlmICh0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQpIHtcbiAgICAgIHRoaXMuX2NhcmREZWxldGVCdXR0b24ucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDsiLCJjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uOyIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcblxuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcblxuICAgIHRoaXMuX3ByZXZpZXdJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsLXByZXZpZXctaW1hZ2VcIik7XG4gICAgdGhpcy5faW1hZ2VDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwtcHJldmlldy1kZXNjcmlwdGlvblwiKTtcbiAgfVxuXG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2Uuc3JjID0gbGluaztcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2UuYWx0ID0gbmFtZTtcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTsiXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJwb3B1cFNlbGVjdG9yIiwiZXZlbnQiLCJrZXkiLCJ0aGlzIiwiY2xvc2UiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiX3BvcHVwRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImJpbmQiLCJvcGVuIiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlU2hhZGVkQ2xvc2UiLCJfaGFuZGxlRXNjQ2xvc2UiLCJfY2xvc2VCdXR0b24iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiUG9wdXAiLCJoYW5kbGVGb3JtU3VibWl0IiwibG9hZGluZ0J1dHRvblRleHQiLCJzdXBlciIsInByZXZlbnREZWZhdWx0IiwiaW5wdXRWYWx1ZXMiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9wb3B1cEZvcm0iLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJfYnV0dG9uVGV4dCIsInRleHRDb250ZW50IiwiX2xvYWRpbmdCdXR0b25UZXh0Iiwic2hvd0xvYWRpbmciLCJoaWRlTG9hZGluZyIsImlucHV0IiwibmFtZSIsInZhbHVlIiwiX29uU3VibWl0IiwicmVzZXQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9mb3JtIiwiX2lucHV0RWxlbWVudHMiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJfZXJyb3JNZXNzYWdlRWxlbWVudCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJpbnB1dExpc3QiLCJldmVyeSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZGlzYWJsZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJmb3JFYWNoIiwiZW5hYmxlVmFsaWRhdGlvbiIsInZhbGlkYXRpb25TZXR0aW5ncyIsImlucHV0RXJyb3JDbGFzcyIsImFwaSIsIm9wdGlvbnMiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiYWxsIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJiYXNlVXJsIiwiaGVhZGVycyIsImZldGNoIiwibWV0aG9kIiwidGhlbiIsIl9wcm9jZXNzUmVzcG9uc2UiLCJlZGl0UHJvZmlsZSIsImRhdGEiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiYWRkQ2FyZCIsImxpbmsiLCJkZWxldGVDYXJkIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJ1cGRhdGVJbWFnZSIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJjYXJkU2VjdGlvbiIsInVzZXJJZCIsInVzZXJJbmZvIiwidXNlck5hbWVTZWxlY3RvciIsInVzZXJKb2JTZWxlY3RvciIsInVzZXJJbWFnZVNlbGVjdG9yIiwiX25hbWUiLCJfam9iIiwiX2ltYWdlIiwiZ2V0QXZhdGFyIiwiaW1hZ2UiLCJzcmMiLCJzZXRVc2VySW5mbyIsInNldEltYWdlIiwiYWx0IiwiY29uZmlybUZvcm0iLCJzZXRTdWJtaXRDYWxsYmFjayIsImNyZWF0ZUNhcmQiLCJpdGVtIiwiY2FyZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwiaXNMaWtlZCIsIl9jYXJkTGlrZUJ1dHRvbiIsIl9jYXJkTGlrZXMiLCJfbGlrZXMiLCJsZW5ndGgiLCJfY2FyZEVsZW1lbnQiLCJfbGluayIsIl9pZCIsImxpa2VzIiwiX293bmVySWQiLCJvd25lciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2NhcmRTZWxlY3RvciIsIl91c2VySWQiLCJnZXRJZCIsIl9jYXJkRGVsZXRlQnV0dG9uIiwiX2ltYWdlRWxlbWVudCIsInVwZGF0ZUxpa2VzIiwicmVuZGVyTGlrZXMiLCJzb21lIiwibGlrZSIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZXRWaWV3IiwiY2FyZFRpdGxlIiwiaW1hZ2VQb3B1cCIsImNhcmRJZCIsImhhbmRsZURlbGV0ZUJ1dHRvbiIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImZpbmFsbHkiLCJnZXRBcHBJbmZvIiwidXNlclJlcyIsImNhcmRSZXMiLCJyZXZlcnNlIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJjYXJkRWxlbWVudCIsIl9wcmV2aWV3SW1hZ2UiLCJfaW1hZ2VDYXB0aW9uIiwiZWRpdEZvcm0iLCJQb3B1cFdpdGhGb3JtIiwidmFsdWVzIiwiYWRkRm9ybSIsIm5ld0NhcmQiLCJyZW5kZXJDYXJkIiwiY2hhbmdlSW1hZ2VGb3JtIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwiY2hhbmdlRm9ybVZhbGlkYXRvciIsImVkaXRQcm9maWxlQnV0dG9uIiwiYWRkUG9wdXBCdXR0b24iLCJwcm9maWxlTmFtZUlucHV0IiwicHJvZmlsZUFib3V0SW5wdXQiLCJwcm9maWxlSW1hZ2VJbnB1dCIsImNoYW5nZVByb2ZpbGVJbWFnZUJ1dHRvbiIsInByb2ZpbGVJbmZvIiwiZmlsbFByb2ZpbGVGb3JtIiwiYXZhdGFySW5mbyIsImZpbGxBdmF0YXJGb3JtIl0sInNvdXJjZVJvb3QiOiIifQ==